<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Danh sách loại rạp</title>
  <style>
    /* Đặt kiểu chung cho body */
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f8f9fa;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #495057;
    }

    h1 {
      text-align: center;
      font-size: 24px;
      color: #333;
      padding: 20px;
      margin-top: 20px;
      border-bottom: 2px solid #dee2e6;
      width: 100%;
      max-width: 600px;
    }

    /* Danh sách loại rạp, rạp và phòng chiếu */
    .theater-type-list, .theater-list, .room-list {
      list-style: none;
      padding: 0;
      margin: 20px auto;
      width: 100%;
      max-width: 600px;
    }

    /* Các mục rạp và phòng chiếu */
    .theater-type-item, .theater-item, .room-item {
      padding: 15px;
      margin: 10px 0;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s, box-shadow 0.2s;
      cursor: pointer;
      position: relative;
    }

    .theater-type-item:hover, .theater-item:hover, .room-item:hover {
      transform: scale(1.02);
      box-shadow: 0 8px 12px rgba(0, 0, 0, 0.2);
    }

    /* Các phần tử con trong mục */
    .theater-type-name, .room-name {
      font-size: 18px;
      font-weight: bold;
      color: #343a40;
    }

    .theater-item-details, .room-details {
      color: #868e96;
      margin-top: 5px;
    }

    /* Phân cách từng phần */
    .divider {
      width: 100%;
      height: 1px;
      background-color: #e9ecef;
      margin: 20px 0;
    }

    /* Thông báo khi không có dữ liệu */
    .empty-message {
      color: #868e96;
      text-align: center;
      font-size: 16px;
      padding: 15px;
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 8px;
    }
  </style>
</head>
<body>

  <h1>Danh sách loại rạp</h1>

  <!-- Danh sách các loại rạp -->
  <ul id="theaterTypeList" class="theater-type-list"></ul>

  <!-- Danh sách rạp sẽ hiển thị khi chọn loại rạp -->
  <div class="divider"></div>
  <ul id="theaterList" class="theater-list"></ul>

  <!-- Danh sách phòng chiếu sẽ hiển thị khi chọn rạp -->
  <div class="divider"></div>
  <ul id="roomList" class="room-list"></ul>

  <script>
    async function fetchTheaterTypes() {
      try {
        const response = await fetch('http://be-movie-sooty.vercel.app/brand/getAll');
        if (!response.ok) throw new Error('Lỗi khi lấy loại rạp');
        
        const theaterTypes = await response.json();
        displayTheaterTypes(theaterTypes);
      } catch (error) {
        alert(error.message);
      }
    }

    async function fetchTheatersByType(typeId) {
      try {
        const response = await fetch(`http://be-movie-sooty.vercel.app/cinema/getByBrand?brandId=${typeId}`);
        if (!response.ok) throw new Error('Lỗi khi lấy danh sách rạp');
        
        const theaters = await response.json();
        displayTheaters(theaters);
      } catch (error) {
        alert(error.message);
      }
    }

    async function fetchRoomsByTheater(theaterId) {
      try {
        const response = await fetch(`http://be-movie-sooty.vercel.app/room/getByCinema?cinema_id=${theaterId}`);
        if (!response.ok) throw new Error('Lỗi khi lấy danh sách phòng chiếu');
        
        const rooms = await response.json();
        displayRooms(rooms);
      } catch (error) {
        alert(error.message);
      }
    }

    function displayTheaterTypes(theaterTypes) {
      const theaterTypeList = document.getElementById('theaterTypeList');
      theaterTypeList.innerHTML = '';

      theaterTypes.forEach(type => {
        const typeItem = document.createElement('li');
        typeItem.className = 'theater-type-item';
        typeItem.textContent = type.name;
        typeItem.onclick = () => fetchTheatersByType(type._id);
        theaterTypeList.appendChild(typeItem);
      });
    }

    function displayTheaters(theaters) {
      const theaterList = document.getElementById('theaterList');
      const roomList = document.getElementById('roomList');
      theaterList.innerHTML = '';
      roomList.innerHTML = '';

      theaters.forEach(theater => {
        const theaterItem = document.createElement('li');
        theaterItem.className = 'theater-item';

        const theaterName = document.createElement('div');
        theaterName.textContent = theater.name;
        theaterName.className = 'theater-type-name';

        const theaterAddress = document.createElement('div');
        theaterAddress.textContent = `Địa chỉ: ${theater.address}`;
        theaterAddress.className = 'theater-item-details';

        theaterItem.appendChild(theaterName);
        theaterItem.appendChild(theaterAddress);
        theaterItem.onclick = () => fetchRoomsByTheater(theater.id);

        theaterList.appendChild(theaterItem);
      });
    }

    function displayRooms(rooms) {
      const roomList = document.getElementById('roomList');
      roomList.innerHTML = '';

      if (rooms.length === 0) {
        const noRoomMessage = document.createElement('li');
        noRoomMessage.textContent = 'Không có phòng chiếu cho rạp này.';
        noRoomMessage.className = 'empty-message';
        roomList.appendChild(noRoomMessage);
      } else {
        rooms.forEach(room => {
          const roomItem = document.createElement('li');
          roomItem.className = 'room-item';

          const roomName = document.createElement('div');
          roomName.textContent = `Phòng: ${room.name}`;
          roomName.className = 'room-name';

          const roomCapacity = document.createElement('div');
          roomCapacity.textContent = `Sức chứa: ${room.capacity} chỗ`;
          roomCapacity.className = 'room-details';

          roomItem.appendChild(roomName);
          roomItem.appendChild(roomCapacity);
          roomList.appendChild(roomItem);
        });
      }
    }

    fetchTheaterTypes();
  </script>

</body>
</html>
